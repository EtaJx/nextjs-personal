```yaml
title: Go指针
date: 2018-07-09 21:48:27
tags:
- Go
categories:
- Go
```

#### Go指针简介

在Go中，不能进行指针运算，通过给予程序员基本内存布局，Go语言允许我们控制特定集合的数据结构、分配的数量以及内存访问模式，这些对构建运行良好的系统是非常重要的：指针对于性能的影响是不言而喻的。

程序在内存中存储它的值，每个内存块（或字）有一个地址，通常用十六进制数表示，Go的取地址符是`&`，放在一个变量前使用就会返回相应变量的内存地址。

```go
var i1 = 5
fmt.Printf("An integer: %d, its location in memory: %p \n", i1, &i1)
// 可能输出`An integer 5, its location in memory: 0x6b0820`, 这个值随每次运行程序而变化
```

这个地址可以存储在一个叫做指针的特殊数据类型中，在上面的代码中，这是一个指向int的指针，即`i1`:此处使用`*int`表示。如果我们想调用指针`intP`，可以这样声明：

```go
var intP *int
```

然后使用`intP = &i1`是合法的，此时`intP`指向`i1`。

`intP`存储了`i1`的内存地址；它指向了`i1`的位置，它引用了变量`i1`。

***一个指针变量可以指向任何一个值得内存地址***，它指向那个值得的内存地址，在32位机器上占用了4个字节，在64位机器上占用8个字节，并且与它所指向的值得大小无关。理解[pointer.go](https://github.com/Neras/golang-poker/blob/master/pointer/pointer.go)的输出内容。

#### 注意事项

- **不能得到一个文字或常量的地址**

- 指针的一个高级应用是可以传递一个变量的引用（如函数的参数），这样不会传递变量的拷贝。指针的传递是很廉价的，只占用4个或这个8个字节。当程序在工作中需要占用大量的内存，或很多变量，或者两者都有，使用指针会减少内存占用和提高效率。被指向的变量也保存在内存中，直到没有任何指针指向它们，所以从它们被创建开始就具有互相独立的生命周期。**另一方面，由于一个指针导致的简介引用（一个进程执行另一个地址），指针的过度频繁使用也会导致性能下降**。

- 指针可以指向另一个指针，并且可以进行任意深度的嵌套。

- 对一个空指针的反向引用是不合法的，并且会使程序崩溃。

  ```go
  package main
  func main() {
    var p *int = nil
    *p = 0
  }
  ```

  

